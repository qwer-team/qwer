{% extends 'ItcAdminBundle::layout.html.twig' %}
{% block menu %}
{% endblock %}
{% block body %}
{{ tinymce_init() }}

<div class = 'menu_sys_top_menu_bg'></div>
<div class = 'menu_sys_main_conteiner'>
<h1 class = 'menu_sys_h1'>{{ "Product edit"|trans({}, "product") }}
    <br />
    <br />
</h1>

<hr />

<div class = 'float_left' style = 'margin-right: 10px'>

    <form id = 'ms_edit_icon' action="{{ path(route~'_update_image', { 'id': entity.id }) }}" method="post" {{ form_enctype(image_form) }}>
        {{form_errors(image_form)}}
        <div class = 'menu_sys_icon_loader'>
            {% if entity.iconImage is not null %}
                <img  class = 'menu_sys_iconImage' style = 'z-index: 0;' src = '{{ vich_uploader_asset(entity, 'iconImage') | apply_filter('my_thumb') }}?0328478327489' />
            {% else %}
                <img style = 'z-index: 0;' src = '/image/m_menu.gif' />
            {% endif %}
            <div> 
                {{ form_widget( image_form["iconImage"], { 'attr': { 'class': 'hidden_loader' } } ) }}
            </div>
                {{ form_rest(image_form) }}
        </div>
    </form>
</div>

<form action="{{ path(route~'_update', { 'id': entity.id }) }}" method="post" {{ form_enctype(edit_form) }}>
    <div class = '' style = 'position: fixed; top: 5px; right: 80px; height: 30px;'>
        <div class = 'fl'>
            <button class = 'menu_sys_save_button' type="submit" alt='Сохранить'>  </button>
        </div>
        
    </div>

    <div class = 'menu_sys_upper_form fl'>
        <div class = 'fl'>
            {{ form_row( edit_form.kod ) }} 
        </div>
        <div class = 'fl'>
            {{ form_row( edit_form.brand ) }} 
        </div>
        <div class = 'fl'>
            {{ form_row( edit_form.productGroup ) }} 
        </div>
        <br class="clr"/>
        <div class = 'fl'>
            {{ form_row( edit_form.price ) }} 
        </div>
        <div class = 'fl'>
            {{ form_row( edit_form.count ) }} 
        </div>
        <div class = 'fl'>
            {{ form_row( edit_form.article ) }} 
        </div>
        <div class = 'fl'>
            {{ form_row( edit_form.warranty ) }} 
        </div>
        <div class = 'fl'>
            {{ form_row( edit_form.productGroup ) }} 
        </div>
        <br class="clr"/>
        <div class = 'fl'>
            {{ form_row( edit_form.unit ) }} 
        </div>
        <div class = 'fl'>
            {{ form_row( edit_form.topSales ) }} 
        </div>
        <div class = 'fl'>
            {{ form_row( edit_form.novelty ) }} 
        </div>
        <div class = 'fl'>
            {{ form_row( edit_form.bestSeller ) }} 
        </div>
        <br class="clr"/>
        {{ form_row( edit_form.relations) }}
        
    </div>
    
    {# какая-то муть по языкам #}
    <br class = 'clr' />
    <hr />
    <div class = 'menu_sys_lang_select'>

        {% for language in languages %}

            {% set lang = language %}
            {% if lang == locale %}{% set current = 'current' %}
            {% else %}{% set current = '' %}
            {% endif %}
            <div class = 'menu_sys_lang_tab {{ current }}' lang = '{{lang}}' rel = '{{lang}}'>

                {{ lang }}
            </div>

        {% endfor %}

        <br class = 'clr' />

        <div class = 'menu_sys_content_show'>

        {% for language in languages %}

            {% set lang = language %}

            {% if lang != locale %} 
                {% set hide = 'hide' %}
            {% else %}
                {% set hide = '' %}
            {% endif %}

            <div class = 'menu_sys_lang_show {{ hide }}' lang = '{{lang}}' rel = '{{lang}}'>

                 <div>
                    {% set desc = edit_form[lang~"Translation.title"] %}
                    {{ form_label(  desc ) }}
                    {{ form_errors( desc ) }}
                    {{ form_widget( desc, { 'attr': {'class': 'menu_sys_input_edit'} }) }}
                </div>
                 <div>
                    {% set desc = edit_form[lang~"Translation.translit"] %}
                    {{ form_label(  desc ) }}
                    {{ form_errors( desc ) }}
                    {{ form_widget( desc, { 'attr': {'class': 'menu_sys_input_edit'} } ) }}
                </div>
                 <div>
                    {% set desc = edit_form[lang~"Translation.metaTitle"] %}
                    {{ form_label(  desc ) }}
                    {{ form_errors( desc ) }}
                    {{ form_widget( desc, { 'attr': {'class': 'menu_sys_input_edit'} } ) }}
                </div>
                 <div>
                    {% set desc = edit_form[lang~"Translation.metaDescription"] %}
                    {{ form_label(  desc ) }}
                    {{ form_errors( desc ) }}
                    {{ form_widget( desc, { 'attr': {'class': 'menu_sys_input_edit'} } ) }}
                </div>
                 <div>
                    {% set desc = edit_form[lang~"Translation.metaKeyword"] %}
                    {{ form_label(  desc ) }}
                    {{ form_errors( desc ) }}
                    {{ form_widget( desc, { 'attr': {'class': 'menu_sys_input_edit'} } ) }}
                </div>
                
                <div>
                    {% set desc = edit_form[lang~"Translation.description"] %}
                    {{ form_label(  desc ) }}
                    {{ form_errors( desc ) }}
                    {{ form_widget( desc, { 'attr': {'class': 'menu_sys_description_input'} }) }}
                </div>
                <div>
                {% set content = edit_form[lang~"Translation.content"] %}
                    {{ form_label(  content ) }}
                    {{ form_errors( content ) }}
                    {# костыль #}
                    {{ form_widget( content, { 'attr': {'style': 'width:85%; height:300px'} }) }}
                </div>
            </div>        

        {% endfor %}

        </div>
    </div>

    <br class="clr" />


    {# какая-то муть по языкам #}
    {{ form_rest(edit_form) }}

</form>

<br class="clr" />
{#
<form action="{{ path('small_image_update', { 'id': entity.id }) }}" method="post">
    <div class = 'menu_sys_main_conteiner w100px'>
        <img  src="{{ vich_uploader_asset(entity, 'smallImage') }}">
    </div>
    <div class = 'menu_sys_main_conteiner'>
    <img id="jcrop_target" src="{{ vich_uploader_asset(entity, 'image') }}">
    {{ form_widget(small_image_form) }}
    </div>
    <div class="w100per t_align">
        <button type="submit">{{ "edit"|trans }}</button>
    </div>
</form>
#}
</div>
{% endblock %}
