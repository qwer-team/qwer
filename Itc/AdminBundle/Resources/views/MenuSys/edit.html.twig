{% extends 'ItcAdminBundle::layout.html.twig' %}
{% block menu %}
    {# скрываем меню #}
{% endblock %}
{% block body %}
{{ tinymce_init() }}
<div class = 'menu_sys_top_menu_bg'></div>

<div class = 'menu_sys_main_conteiner'>

<h1 class = 'menu_sys_h1'>{{ "MenuSys edit"|trans({}, "menu_sys") }}
    <br />
    {{ "id"|trans }}: {{ entity.id }}; {{ "date_create"|trans}}: 
    {% if entity.datecreate %}
        {{ entity.datecreate|date('Y-m-d H:i:s') }}
    {% endif %}
</h1>

<hr />

<div class = 'float_left' style = 'margin-right: 10px'>

    <form id = 'ms_edit_icon' action="{{ path('menu_sys_update_image', { 'id': entity.id }) }}" method="post" {{ form_enctype(image_form) }}>
        <div class = 'menu_sys_icon_loader'>
            {% if entity.iconImage is not null %}
                <img  class = 'menu_sys_iconImage' style = 'z-index: 0;' src = '{{ vich_uploader_asset(entity, 'iconImage') | apply_filter('my_thumb') }}' />
            {% else %}
                <img style = 'z-index: 0;' src = '/image/m_menu.gif' />
            {% endif %}
            <div> 
                {{ form_widget( image_form["iconImage"], { 'attr': { 'class': 'hidden_loader' } } ) }}
            </div>
                {{ form_rest(image_form) }}
        </div>

        {#<button type="submit">Edit</button>#}
    </form>

</div>

<form action="{{ path('menu_sys_delete', { 'id': entity.id }) }}" method="post">
    {{ form_widget(delete_form) }}
    <button class = 'menu_sys_delete_button' type="submit" alt='Delete'></button>
</form>

<form action="{{ path('menu_sys_update', { 'id': entity.id }) }}" method="post" {{ form_enctype(edit_form) }}>
    <div class = 'fl'>
        <button class = 'menu_sys_save_button' type="submit" alt='Сохранить'>  </button>
    </div>

    <div class = 'menu_sys_upper_form fl'>
        <div class = 'fl'>
            {{ form_row( edit_form.kod ) }}
            {{ form_row( edit_form.routing ) }}
        </div>
        <div class = 'fl'>
            {{ form_row( edit_form.tag ) }}
            {{ form_row( edit_form.parent_id ) }}
        </div>
        <div class = 'fl'>
            {{ form_row( edit_form.visible ) }}
        </div>
    </div>
    
    {# какая-то муть по языкам #}
    <br class = 'clr' />
    <hr />
    <div class = 'menu_sys_lang_select'>

        {% for language in languages %}

            {% set lang = language %}
            {% if lang == locale %}{% set current = 'current' %}
            {% else %}{% set current = '' %}
            {% endif %}
            <div class = 'menu_sys_lang_tab {{ current }}' lang = '{{lang}}' rel = '{{lang}}'>

                {{ lang }}
            </div>

        {% endfor %}

        <br class = 'clr' />

        <div class = 'menu_sys_content_show'>

        {% for language in languages %}

            {% set lang = language %}

            {% if lang != locale %} 
                {% set hide = 'hide' %}
            {% else %}
                {% set hide = '' %}
            {% endif %}

            <div class = 'menu_sys_lang_show {{ hide }}' lang = '{{lang}}' rel = '{{lang}}'>

                 <div>
                    {% set desc = edit_form[lang~"Translation.title"] %}
                    {{ form_label(  desc ) }}
                    {{ form_errors( desc ) }}
                    {{ form_widget( desc, { 'attr': {'class': 'menu_sys_input_edit'} }) }}
                </div>
                 <div>
                    {% set desc = edit_form[lang~"Translation.translit"] %}
                    {{ form_label(  desc ) }}
                    {{ form_errors( desc ) }}
                    {{ form_widget( desc, { 'attr': {'class': 'menu_sys_input_edit'} } ) }}
                </div>
                 <div>
                    {% set desc = edit_form[lang~"Translation.metaTitle"] %}
                    {{ form_label(  desc ) }}
                    {{ form_errors( desc ) }}
                    {{ form_widget( desc, { 'attr': {'class': 'menu_sys_input_edit'} } ) }}
                </div>
                 <div>
                    {% set desc = edit_form[lang~"Translation.metaDescription"] %}
                    {{ form_label(  desc ) }}
                    {{ form_errors( desc ) }}
                    {{ form_widget( desc, { 'attr': {'class': 'menu_sys_input_edit'} } ) }}
                </div>
                 <div>
                    {% set desc = edit_form[lang~"Translation.metaKeyword"] %}
                    {{ form_label(  desc ) }}
                    {{ form_errors( desc ) }}
                    {{ form_widget( desc, { 'attr': {'class': 'menu_sys_input_edit'} } ) }}
                </div>
                
                <div>
                    {% set desc = edit_form[lang~"Translation.description"] %}
                    {{ form_label(  desc ) }}
                    {{ form_errors( desc ) }}
                    {{ form_widget( desc, { 'attr': {'class': 'menu_sys_description_input'} }) }}
                </div>
                <div>
                {#{ form_row( edit_form[lang~"Translation.description"] ) }#}
                {% set content = edit_form[lang~"Translation.content"] %}
                    {{ form_label(  content ) }}
                    {{ form_errors( content ) }}
                    {# костыль #}
                    {{ form_widget( content, { 'attr': {'style': 'width:85%; height:300px'} }) }}
                </div>
            </div>        

        {% endfor %}

        </div>
    </div>

    <br class="clr" />

    {# какая-то муть по языкам #}
    {{ form_rest(edit_form) }}

</form>


</div>
{% endblock %}
{#
<ul class="record_actions">
    <li>
        <a href="{{ path('menu_sys', {"parent_id" : entity.getParentId()}) }}">
            {{"Back to the list" | trans | capitalize}}
        </a>
    </li>
#}